---
---

<section class="hero">
  <svg class="hero-curves" viewBox="0 0 1440 800" preserveAspectRatio="xMidYMid slice">
    <path class="curve-line curve-1" d="M-100,350 Q300,250 600,400 T1100,300 T1600,380">
      <animate attributeName="d" dur="80s" repeatCount="indefinite" values="
        M-100,350 Q300,250 600,400 T1100,300 T1600,380;
        M-100,380 Q300,320 600,280 T1100,400 T1600,320;
        M-100,320 Q300,400 600,350 T1100,250 T1600,400;
        M-100,350 Q300,250 600,400 T1100,300 T1600,380
      " calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" />
    </path>
    <path class="curve-line curve-2" d="M-100,380 Q400,500 700,320 T1200,450 T1600,350">
      <animate attributeName="d" dur="100s" repeatCount="indefinite" values="
        M-100,380 Q400,500 700,320 T1200,450 T1600,350;
        M-100,420 Q400,300 700,480 T1200,320 T1600,420;
        M-100,350 Q400,450 700,380 T1200,500 T1600,380;
        M-100,380 Q400,500 700,320 T1200,450 T1600,350
      " calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" />
    </path>
    <path class="curve-line curve-3" d="M-100,420 Q250,300 550,450 T1000,350 T1600,420">
      <animate attributeName="d" dur="120s" repeatCount="indefinite" values="
        M-100,420 Q250,300 550,450 T1000,350 T1600,420;
        M-100,380 Q250,480 550,320 T1000,450 T1600,350;
        M-100,450 Q250,350 550,400 T1000,300 T1600,450;
        M-100,420 Q250,300 550,450 T1000,350 T1600,420
      " calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" />
    </path>
    <path class="curve-line curve-4" d="M-100,460 Q350,550 650,380 T1150,480 T1600,400">
      <animate attributeName="d" dur="90s" repeatCount="indefinite" values="
        M-100,460 Q350,550 650,380 T1150,480 T1600,400;
        M-100,420 Q350,380 650,520 T1150,350 T1600,480;
        M-100,480 Q350,450 650,400 T1150,520 T1600,380;
        M-100,460 Q350,550 650,380 T1150,480 T1600,400
      " calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" />
    </path>
    <path class="curve-line curve-5" d="M-100,500 Q280,380 580,500 T1050,400 T1600,480">
      <animate attributeName="d" dur="110s" repeatCount="indefinite" values="
        M-100,500 Q280,380 580,500 T1050,400 T1600,480;
        M-100,480 Q280,550 580,400 T1050,520 T1600,420;
        M-100,520 Q280,420 580,480 T1050,380 T1600,500;
        M-100,500 Q280,380 580,500 T1050,400 T1600,480
      " calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" />
    </path>
  </svg>
  <canvas id="particle-canvas"></canvas>
  
  <div class="container hero-content">
    <div class="terminal-line animate-fade-in-up">
      <span class="terminal-prompt">$</span>
      <span class="terminal-command">init</span>
      <span class="terminal-text">wxyz_foundation</span>
      <span class="cursor"></span>
    </div>
    
    <h1 class="hero-title animate-fade-in-up animate-delay-1">
      Building Tomorrow's<br />
      <span class="text-accent">Solutions</span>
    </h1>
    
    <p class="hero-description animate-fade-in-up animate-delay-2">
      We provide grants to initiatives that strengthen health, 
      uplift communities, and expand access to education.
    </p>
    
    <div class="hero-actions animate-fade-in-up animate-delay-3">
      <a href="mailto:hello@wxyz.foundation" class="btn btn-primary">
        <span>Get in Touch</span>
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
  </div>
</section>

<script>
  class Particle {
    x: number;
    y: number;
    size: number;
    speedX: number;
    speedY: number;
    opacity: number;
    isAccent: boolean;

    constructor(canvas: HTMLCanvasElement) {
      this.x = Math.random() * canvas.width;
      this.y = Math.random() * canvas.height;
      this.size = Math.random() * 2 + 0.5;
      this.speedX = (Math.random() - 0.5) * 0.3;
      this.speedY = (Math.random() - 0.5) * 0.3;
      this.opacity = Math.random() * 0.4 + 0.1;
      this.isAccent = Math.random() > 0.85;
    }

    update(canvas: HTMLCanvasElement, mouseX: number, mouseY: number) {
      this.x += this.speedX;
      this.y += this.speedY;

      const dx = this.x - mouseX;
      const dy = this.y - mouseY;
      const distance = Math.sqrt(dx * dx + dy * dy);
      const maxDistance = 100;

      if (distance < maxDistance && mouseX !== -1) {
        const force = (maxDistance - distance) / maxDistance;
        const angle = Math.atan2(dy, dx);
        this.x += Math.cos(angle) * force * 0.8;
        this.y += Math.sin(angle) * force * 0.8;
      }

      if (this.x < 0) this.x = canvas.width;
      if (this.x > canvas.width) this.x = 0;
      if (this.y < 0) this.y = canvas.height;
      if (this.y > canvas.height) this.y = 0;
    }

    draw(ctx: CanvasRenderingContext2D, particleColor: string, accentColor: string) {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
      if (this.isAccent) {
        ctx.fillStyle = `rgba(${accentColor}, ${this.opacity + 0.2})`;
      } else {
        ctx.fillStyle = `rgba(${particleColor}, ${this.opacity})`;
      }
      ctx.fill();
    }
  }

  function initParticles() {
    const canvas = document.getElementById('particle-canvas') as HTMLCanvasElement;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    let particles: Particle[] = [];
    let mouseX = -1;
    let mouseY = -1;
    let animationId: number;

    function getColors() {
      const style = getComputedStyle(document.documentElement);
      return {
        particle: style.getPropertyValue('--particle-color').trim() || '113, 113, 122',
        accent: style.getPropertyValue('--particle-accent').trim() || '37, 99, 235'
      };
    }

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      initParticleArray();
    }

    function initParticleArray() {
      particles = [];
      const particleCount = Math.min(Math.floor((canvas.width * canvas.height) / 15000), 80);
      for (let i = 0; i < particleCount; i++) {
        particles.push(new Particle(canvas));
      }
    }

    function animate() {
      ctx!.clearRect(0, 0, canvas.width, canvas.height);
      const colors = getColors();

      particles.forEach(particle => {
        particle.update(canvas, mouseX, mouseY);
        particle.draw(ctx!, colors.particle, colors.accent);
      });

      animationId = requestAnimationFrame(animate);
    }

    window.addEventListener('resize', resize);

    canvas.addEventListener('mousemove', (e) => {
      const rect = canvas.getBoundingClientRect();
      mouseX = e.clientX - rect.left;
      mouseY = e.clientY - rect.top;
    });

    canvas.addEventListener('mouseleave', () => {
      mouseX = -1;
      mouseY = -1;
    });

    canvas.addEventListener('touchmove', (e) => {
      const rect = canvas.getBoundingClientRect();
      mouseX = e.touches[0].clientX - rect.left;
      mouseY = e.touches[0].clientY - rect.top;
    });

    canvas.addEventListener('touchend', () => {
      mouseX = -1;
      mouseY = -1;
    });

    resize();
    animate();

    document.addEventListener('astro:before-swap', () => {
      cancelAnimationFrame(animationId);
      window.removeEventListener('resize', resize);
    });
  }

  document.addEventListener('DOMContentLoaded', initParticles);
  document.addEventListener('astro:page-load', initParticles);
</script>

<style>
  .hero {
    min-height: 100vh;
    display: flex;
    align-items: flex-start;
    position: relative;
    overflow: hidden;
    background: var(--hero-gradient);
    transition: background var(--transition-medium);
  }

  .hero-curves {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  .curve-line {
    fill: none;
    stroke: var(--curve-color);
    stroke-width: 1.5;
    stroke-linecap: round;
    transition: stroke var(--transition-medium);
  }

  .curve-1 { stroke-opacity: 0.4; }
  .curve-2 { stroke-opacity: 0.5; }
  .curve-3 { stroke-opacity: 0.6; }
  .curve-4 { stroke-opacity: 0.5; }
  .curve-5 { stroke-opacity: 0.4; }

  #particle-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: auto;
    z-index: 0;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    pointer-events: none;
    padding-top: 14rem;
  }

  .hero-content > * {
    pointer-events: auto;
  }

  .terminal-line {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-family: var(--font-mono);
    font-size: 0.875rem;
    margin-bottom: 1.5rem;
    padding: 0.625rem 1.25rem;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    transition: background var(--transition-medium), border-color var(--transition-medium);
  }

  .terminal-prompt {
    color: var(--accent);
  }

  .terminal-command {
    color: var(--text-secondary);
  }

  .terminal-text {
    color: var(--text-muted);
  }

  .cursor {
    display: inline-block;
    width: 8px;
    height: 1em;
    background: var(--accent);
    animation: blink 1s step-end infinite;
    margin-left: 0.25rem;
  }

  .hero-title {
    font-family: var(--font-display);
    font-weight: 400;
    margin-bottom: 1.5rem;
    opacity: 0;
    letter-spacing: -0.02em;
    line-height: 1.1;
  }

  .hero-description {
    font-family: var(--font-serif);
    font-size: 1.25rem;
    max-width: 650px;
    margin-bottom: 2.5rem;
    opacity: 0;
    color: var(--text-secondary);
    line-height: 1.7;
  }

  .hero-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
    opacity: 0;
  }

  @media (max-width: 768px) {
    .hero-content {
      padding-top: 8rem;
    }

    .hero-actions .btn {
      width: 100%;
      max-width: 280px;
      justify-content: center;
    }
  }
</style>
